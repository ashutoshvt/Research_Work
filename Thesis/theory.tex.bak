This chapter focuses on covering the necessary theoretical background 
for deriving the coupled cluster (CC) response functions.
%and identifying
%the challenges associated with these approaches.
As a prelude to the CC response theory, the formalism for obtaining ground state CC energies 
is discussed after a brief description of Hartree-Fock and Configuration Interaction models.
The next section derives the simplified gradient expressions of the CC energy and subsequently 
parametrizes the left hand CC wavefunction.
\section{Hartree-Fock Theory}
Central to the field of quantum mechanics is the equation proposed by Erwin Schr\"odinger 
in 1926 or the Schr\"odinger's equation \cite{Schrodinger26}. One of the biggest factors 
contributing to the rich diversity of quantum chemical theories is the fact that Schr\"odinger's equation (SE)
is exactly solvable for only one electron systems like hydrogen atom. As such, numerous approximations
have been proposed over the years to solve this equation for many electron systems.
The Hartree-Fock (HF) theory\cite{SzaboOstlund} is one of the simplest approaches in this regard
under the Born-Oppenheimer approximation\cite{Born27}. %in non-relativistic regimes. 
This model attempts to transform the many body problem of SE into a one body problem where each electron
only interacts with a mean field created by the other electrons. For an N-electron system, the HF 
wavefunction is a Slater determinant (obeys Pauli's antisymmetry principle naturally) composed of N 
spin orbitals, i.e. the one electron solutions of the HF equation. Following is a brief outline
of the HF procedure: A Lagrangian is constructed with the HF energy (the expectation value of the 
Slater determinant) coupled with the constraint of the spin orbitals always remaining 
orthonormal to each other. The Lagrangian, thus, can be seen as a functional of the spin 
orbitals. In the next step, the variational principle is employed to set the first order 
change in the Lagrangian with respect to spin orbitals to zero. Finally, one obtains 
a non-linear eigenvalue equation where the spin orbitals are the eigenfunctions of 
the Fock operator which itself depends on the spin orbitals themselves. 
Thus, the equation is solved in a self-consistent manner usually in conjunction with 
the linear combination of atomic orbital (LCAO) approach, where the spin 
orbitals are expressed as a linear combination of basis functions and the 
coefficients are determined from the solving a generalized eigenvalue equation.
The eigenvectors with the lowest N eigenvalues are the occupied orbitals, usually 
denoted by symbols $i,j,k,l,..$. If a basis set of size $K$ is employed, the remaining $K-N$
orbitals are termed as unoccupied or virtual orbitals usually denoted by symbols $a,b,c,d,..$.
\\\\
Even with this mean field approach, one can extract almost 95-98\% of the total 
electronic energy. The remaining energy, also known as the correlation energy,
however, is very essential if one wants to attain ``chemical accuracy", ex.  
1kcal/mol for interaction energies. In spite of this, the simple yet robust 
structure of the HF procedure makes it one of the most popular reference 
wavefunctions for more complicated and accurate theoretical models.
\section{Configuration Interaction Method}
Configuration interaction (CI) method\cite{Shavitt77,Sherrill98:CI} attempts to solve the time independent 
Schr\"odinger's (TISE) by recasting it into a matrix eigenvalue problem, 
\begin{equation}
HC = EC
\end{equation}
where H is the matrix representation of the Hamiltonian, C is the coefficient matrix
whose columns are the eigenvectors of the Hamiltonian and E is the diagonal matrix 
containing the eigenvalues or electronic energies (The lowest energy corresponds to 
the ground state wavefunction). If the vector space used to represent the Hamiltonian 
is complete, the CI approach, then popularly known as the Full CI method gives exact 
wavefunctions and electronic energies. Specifically, this model uses a vector space 
composed of substituted or excited Slater determinants which can form a complete
space in the limit of an infinite one electron basis. Furthermore, this vector space 
also has the desired properties of antisymmetry and orthogonality. Indeed the Full 
CI wavefunction is a linear combination of all possible Slater determinants for a given basis set,
\\
\begin{equation}
\ket{\Psi} = c_o\ket{0} + \sum_{ia}{c}_{i}^{a}\ket{{\Psi}^a_i} + \sum_{i>j,a>b}c_{ij}^{ab}\ket{\Psi^{ab}_{ij}} + \sum_{i>j>k,a>b>c}c_{ijk}^{abc}\ket{\Psi^{abc}_{ijk}} + ...
\end{equation}
\\
where $\ket{0}$ is the reference wavefunction (usuallly HF), $\ket{{\Phi}^a_i}$ refers to a singly excited determinant where an occupied orbital $i$ of the reference wavefunction is replaced by a virtual orbital $a$
and so on.\\
However, the Full CI method is computationally very expensive and scales factorially with 
system size. Unsurprsingly, it is mostly used in benchmark calculations of small molecules.
% and the largest Full CI calculation to date has been on nitrogen molecule\cite{} involving 
%billions of determinants. 
In practice, truncated CI methods like CISD, CISDT where the vector 
space is restricted to include up to doubly and triply excited determinants 
is used. Unlike the exact wavefunction, truncated CI wavefunctions, however, 
do not posess the property of size-extensivity i.e. the CIS[D/T] energy doesn't scale 
linearly with the number of electrons in the asymptotic limit. Another notable deficiency 
is the lack of size-consistency which means that within these approaches, the sum of the 
energies of non-interacting fragments (each calculated separately) is not equal to the energy 
of the supermolecule when all the fragments are included in the calculations.
As a result, the accuracy of these methods decreases progressively as the size of the system increases.
%.These methods can extract up to 95\% of correlation energy\cite{HarrisonHandy83} and
%can be applied to solve for excited states, open-shell systems and systems that
%are far from their equilibrium geometry, which makes them very useful.
\section{Coupled Cluster Theory} 
%\paragraph{Coupled cluster theory} ~ \\\\
Coupled cluster (CC) theory\cite{Cizek66,Cizek69,Cizek71} is an alternative formulation of the TDSE which attempts to 
reproduce the Full CI wavefunction through an exponential parametrization
of the wavefunction. The CC wavefunction can be obtained by the operation of cluster
operators $\hat{T}$ acting on the reference Slater determinant. 
%is one of the most accurate yet computationally
%affordable method, which is very widely used in quantum chemistry.CC
%wavefunction is an exponential ansatz\cite{Crawford00} which incorporates the electron
%correlation effects through cluster operators 
%$\hat{T}$.  
\\
\begin{equation}
\ket{\Psi_{CC}} = e^{\hat{T}}\ket{0} , 
\end{equation}
where,
\begin{equation}
 \hat{T} = \hat{T_1} + \hat{T_2} + \hat{T_3} + ... \;\hat {T_n}.
\end{equation}
\\
Here $\ket{0}$ is the reference wavefunction, usually taken as the HF
wavefunction. One of the most popular tools used for the derivation of the 
complicated CC equations is second-quantization\cite{JorgensenSimons81}.
The $\hat{T_2}$ operator in SQ form can be written as
\\
\begin{equation}
\hat{T_2} = \frac{1}{4}\sum_{ijab}t^{ab}_{ij}\{a^\dagger_aa^\dagger_ba_ja_i\}.
\end{equation}
\\
%\begin{equation}
%\hat{T_1} = \sum_{ia}t^a_i\{{a}^\dagger_a a_i\}
%\end{equation}
where ${a}^\dagger_a$ (or ${a}^\dagger_b)$ is called a creation operator as it 
creates a new particle state (virtual orbital) when it acts on a Slater determinant.
\begin{equation}
{a}^\dagger_a\ket{\phi_b...\phi_d} = \ket{\phi_a\phi_b...\phi_d}.
\end{equation}
Here, $\ket{\phi_a\phi_b...\phi_d}$ is a shorthand notation (Dirac) for a Slater determinant
with orbitals $a,b,..d$. The $a_i$ (or $a_j$) operator on other hand is called 
as annihilation operator as it removes a hole state (occupied orbital) when it 
acts on a Slater determinant.
\begin{equation}
a_i\ket{\phi_i\phi_j...\phi_l} = \ket{\phi_j...\phi_l}.
\end{equation}
Thus, the action of the $\hat{T_2} $ operator on a Slater determinant creates a 
linear combination of all doubly excited determinants with corresponding coefficients
$t^{ab}_{ij}$ which can be seen as the contribution of virtual orbitals $a$ and $b$
to the pair correlation function $f_{ij}$, which correlates the motions of any two 
electrons associated with occupied orbitals $i$ and $j$. 
\\
\begin{equation}
\begin{split}
& \hat{T_2} = \sum_{ij}f_{ij} \\
& f_{ij} = \frac{1}{4}\sum_{ab}t^{ab}_{ij}\{a^\dagger_aa^\dagger_ba_ja_i\}\\
\end{split}
\end{equation}
\\
Similarly, the ${\hat{T_3}}$ operator correlates the motion of all triplets of electrons. 
The $\hat{T_1}$ operator on the other hand captures the ``adjustment of the one-electron basis"\cite{Crawford00} 
as the effect of other correlation operators is added to the wavefunction.
\\
\begin{equation}
\hat{T_1} = \sum_{ia}t^a_i\{{a}^\dagger_a a_i\}
\end{equation}
\\
In general, the structure of these cluster operators can be shown as,
\\
\begin{equation}
\hat{T_n} = {\bigg(\frac{1}{n!}\bigg)}^2\sum_{ij..ab..}^nt^{ab..}_{ij..}\{a^\dagger_aa^\dagger_b...a_ja_i\}
\end{equation}
\\
%\subsubsection{Coupled Cluster energy}
%\paragraph{Coupled Cluster energy}~ \\
Expanding the ``exponential ansatz" of the CC wavefunction,
\\
\begin{equation}
\ket{\Psi_{CC}} = (1+(\hat{T_1} + \hat{T_2} + \hat{T_3} + ... ) + \frac{1}{2!}{(\hat{T_1} + \hat{T_2} + \hat{T_3} + ...)}^2 + ... )\ket{0}
\end{equation}
\\
a linear combination of all possible Slater determinants is obtained, which in the basis set limit,  
should be an exact solution of the TISE just like the Full CI wavefunction. 
\\
\begin{equation}
\hat{H}e^{\hat{T}}\ket{0} = E_{cc}\;e^{\hat{T}}\ket{0}
\end{equation}
\\
The Hamiltonian is also expressed in second-quantized form \cite{Crawford00}:
\\
\begin{equation}
\hat{H} = \sum_{pq}h_{pq}\{a^\dagger_pa_q\} + \frac{1}{4}\sum_{pqrs}\bra{pq}\ket{rs}\{a^\dagger_pa^\dagger_qa_sa_r\}
\end{equation}
\\
where, $h_{pq} = \langle p|h|q \rangle$ and $\langle pq||rs \rangle = \langle pq|rs \rangle - \langle pq|sr \rangle$ are the one and two electron components of the Hamiltonian respectively.
The CC equations for calculating the amplitudes and the energy can be  
obtained by multiplying equation (2.12) by the inverse of the exponential operator i.e.
$e^{-\hat{T}}$ and projecting it against the reference and excited
determinants.
\\
\begin {equation}
\bra{0}e^{-\hat{T}}\hat{H}e^{\hat{T}}\ket{0} = E_{cc}
\end{equation}
\begin{equation}
%\bra{\Psi^{ab..}_{ij..}}e^{-\hat{T}}\hat{H}e^{\hat{T}}\ket{\Psi_o} = E\cancelto{0}{\bra{\Psi^{ab..}_{ij..}}\Psi_o\rangle} = 0 .
\bra{\mu}e^{-\hat{T}}\hat{H}e^{\hat{T}}\ket{0} = 0 .
\end{equation} 
\\
Here $\mu$ can refer to any excited Slater determinant: singles, doubles etc. 
The similarity transformed Hamiltonian $e^{-\hat{T}}\hat{H}e^{\hat{T}}$, also written as 
$\bar{H}$ can be expressed in terms of commutators of the Hamiltonian with the 
cluster operators $\hat{T}$ by using the Campbell-Baker-Hausdorff formula\cite{Merzbacher70}.
\\
\begin{equation}
e^{-\hat{T}}\hat{H}e^{\hat{T}} = \hat{H} + \lbrack\hat{H},\hat{T}\rbrack + \frac{1}{2!}\lbrack\lbrack\hat{H},\hat{T}\rbrack,\hat{T}\rbrack + \frac{1}{3!}\lbrack\lbrack\lbrack\hat{H},\hat{T}\rbrack,\hat{T}\rbrack,\hat{T}\rbrack + \frac{1}{4!}\lbrack\lbrack\lbrack\lbrack\hat{H},\hat{T}\rbrack,\hat{T}\rbrack,\hat{T}\rbrack,\hat{T}\rbrack + ...
\end{equation}
\\
The expansion truncates naturally at the four nested commutator term since the Hamiltonian is at most a two 
electron operator and the cluster operators commute among themselves\cite{Crawford00}.
%Also, the second quantized form of the Hamiltonian can be written as\cite{Crawford00}:
%\begin{equation}
%\hat{H} = \sum_{pq}h_{pq}\{a^\dagger_pa_q\} + \frac{1}{4}\sum_{pqrs}\bra{pq}\ket{rs}\{a^\dagger_pa^\dagger_qa_sa_r\}
%\end{equation}
Invoking Wick's theorem\cite{Wick50}, the CC energy equation gets simplified as:
\\
\begin{equation}
E_{cc} = E_o + \sum_{ia}f_{ia}t^a_i + \frac{1}{4}\sum_{aibj}\bra{ij}\ket{ab}t^{ab}_{ij} + \frac{1}{2}\sum_{aibj}\bra{ij}\ket{ab}t^a_it^b_j.
\end{equation} 
\\
The non-linear amplitude equations are solved iteratively until the change in energies
falls below a convergence threshold. However, just like its CI counterpart, Full CC is 
computationally impractical and hence, truncated CC methods like CCSD:\;$\hat{T} =
\hat{T_1} + \hat{T_2}$, CCSDT:\;$\hat{T} = \hat{T_1} + \hat{T_2} + \hat{T_3}$, 
are used. The exponential structure of the CC wavefunction makes the truncated CC methods 
more efficient and accurate than the corresponding linear CI methods. For example,
the CCSD wavefunction implicitly includes the triples and quadruples excitation contributions to 
its singles and doubles amplitude equations because of the products of cluster operators like 
$\hat{T_1}\hat{T_2}$, ${(\hat{T_2})}^2$ etc., unlike the CISD method, which can only include 
singles and doubles excitation contributions. Furthermore, CC energies have the desired 
properties of size-extensivity and size-consistency (provided the reference wavefunction is
size-consistent). Unsurprisingly, the CCSD(T)\cite{Shen12} method, which approximates the triples using
perturbation theory is considered to be the ``gold standard" of quantum chemistry.
%Also, one of the major advantages with the CC truncation methods is their
%size-extensivity which makes them very useful. 
However, CC methods just like their CI counterparts, are computationally expensive: 
CCSD, CCSD(T), CCSDT scale as $O(N^6)$, $O(N^7)$, $O(N^8)$ respectively, where $N$ 
is the number of basis functions.\\
%and is routinely used for accurate results only for small molecules. While CCSD(T)
%gives very good results for molecules at their equilibrium geometry, it fails
%to describe diradical species and bond-breaking. CCSDT and CCSDTQ methods are
%used virtually exclusively for high accuracy calculations of small molecules
%as they are very computationally expensive.
%\paragrpah{\bf{CC analytic derivatives}} ~\\\\
\subsection{Coupled Cluster Analytic Gradients}
%\paragraph{CC analytic derivatives} ~ \\\\
%Molecular properties like dipole
%moments, IR intensities, force constants etc., depend upon the gradients of the
%molecular energy with respect to external perturbations. 
%In this section, a derivation of first order gradient expressions of the CC method is presented.\\
%If we take the derivative of the CC energy directly with respect to any perturbation 
%X,
%, we get
%\begin{equation}
%\frac{\partial{E_{cc}}}{\partial X} = \bra{\phi_0}\frac{\partial{\bar H}}{\partial X}\ket{\phi_0},
%\end{equation}
%If we use the above equation for calculating gradients, 
%we need to calculate
%$\frac{\partial{t^a_i}}{\partial X}, \frac{\partial{t^{ab}_{ij}}}{\partial X}$
%, we need to calculate the derivatives of non-linear amplitude equations, 
%which makes it very computationally expensive. As a result, a different 
%approach is used where one needs to solve some linear equations i.e. 
%the Lambda equations, which are independent of the perturbation. 
%In this section, a derivation of first order gradient expressions 
%of CC method is presented using this approach.\\
The gradient of the CC energy (equation 2.14) with respect to any external perturbation X 
can be written as:
\\
\begin{equation}
\frac{\partial{E_{cc}}}{\partial X} = \bra{0}\frac{\partial{\bar H}}{\partial X}\ket{\Psi_o} = \bra{\Psi_o}{\bar{H}}^X + \lbrack\bar H , \frac{\partial{\hat T}}{\partial X}\rbrack\ket{\Psi_o} 
\end{equation}
where, 
\begin{equation}
{\bar{H}}^X =  e^{-\hat{T}}\frac{\partial{\hat H}}{\partial X}e^{\hat{T}}.
\end{equation}
\\
Invoking the resolution of identity (RI),
\\
\begin{equation}
 1 = \ket{0}\bra{0} + \sum_{ia}\ket{{\Psi}^a_i}\bra{{\Psi}^a_i} + \frac{1}{4}\sum_{ijab}\ket{{\Psi}^{ab}_{ij}}\bra{{\Psi}^{ab}_{ij}} + ...
\end{equation}
\\
equation (2.18) can be seen to involve the derivatives of the amplitudes i.e $\frac{\partial{t_\mu}}{\partial X}$
\\
\begin{equation}
\frac{\partial{E_{cc}}}{\partial X} = \bra{0}{\bar{H}}^X\ket{0} + \sum_{\mu}\bra{0}\bar{H}\ket{\mu} \frac{\partial{t_{\mu}}}{\partial X}
%\bra{{\Psi}^{a.}_{i.}}\frac{\partial{\hat T}}{\partial X}\ket{\Psi_o}.
\end{equation}
\\
Calculating gradients using this approach would require taking the derivative of the non-linear equations
used to solve for the amplitudes, which could be computationally demanding. However, explicit gradient 
calculations of the amplitudes can be avoided altogether through an alternative formulation.
Taking the derivative of the CC amplitude equations with respect to X, 
\\
\begin{equation} 
0 = \bra{\mu}{\bar{H}}^X + \lbrack\bar H , \frac{\partial{\hat T}}{\partial
X}\rbrack\ket{0}.
\end{equation} 
\\
and using the RI method again, the above equation can be simplified as
\\
\begin{equation}
\sum_{\nu}\bra{\mu}\bar{H}-E_{cc}\ket{\nu} \frac{\partial{t_\nu}}{\partial X}
= - \bra{\mu}{\bar{H}}^X\ket{0}
%\bra{{\Psi}^{b.}_{j.}}\frac{\partial{\hat T}}{\partial X}\ket{\Psi_o} = - \bra{{\Psi}^a_i}{\bar{H}}^X\ket{\Psi_o} 
\end{equation}
or,
\begin{equation} 
%\bra{{\Psi}^{b.}_{j.}}\frac{\partial{\hat T}}{\partial X}\ket{\Psi_o} 
\frac{\partial{t_\mu}}{\partial X} = -\sum_{\nu}
\bra{\mu}{(\bar{H}-E_{cc})}^{-1}\ket{\nu}\bra{\nu}{\bar{H}}^X\ket{0}
\end{equation}
\\
%The above equation was derived by considering the gradient of just the singles equation.
%Including the gradient of all the other amplitude equations and plugging the modified 
Plugging this gradient expression back into equation (2.21), we obtain the following expression,
\\
\begin{equation}
\frac{\partial{E_{cc}}}{\partial X} = \bra{0}{\bar{H}}^X\ket{0} -
\sum_{\mu}\bra{0}\bar{H}\ket{\mu}\sum_{\nu}
\bra{\mu}{(\bar{H}-E_{cc})}^{-1}\ket{\nu}
\bra{\nu}{\bar{H}}^X\ket{0}.
\end{equation}
\\
The second term of the RHS of the above equation involves an inverted 
$\bar{H}$ matrix which needs to be avoided at all costs as the dimensions
of this matrix can be very large. As such, a linear operator $\hat{\Lambda}$
is defined in the following manner.
\\
\begin{equation}
\bra{0}\hat{\Lambda}\ket{\mu} = -\sum_{\nu}\bra{0}\bar{H}\ket{\nu}
\bra{\nu}{(\bar{H}-E_{cc})}^{-1}\ket{\mu}.
\end{equation}
or, 
\begin{equation}
\sum_{\mu}\bra{0}\hat{\Lambda}\ket{\mu}\bra{\mu}{(\bar{H}-E_{cc})}\ket{\nu}
 = - \bra{0}\bar{H}\ket{\nu}.
%\bra{{\Psi}^{a.}_{i.}}{(\bar{H}-E_{cc})}^{-1}\ket{{\Psi}^{b.}_{j.}}.
\end{equation}
\\
It can be easily seen from above equations that $\hat{\Lambda}$ is a linear de-excitation operator,
\begin{equation}
\hat{\Lambda} = \hat{\Lambda}_1 + \hat{\Lambda}_2 + \hat{\Lambda}_3 + ...,
\end{equation} 
\\
where $\hat{\Lambda}_1 = \sum\limits_{ia}\lambda^i_a\{{a}^\dagger_i a_a\}$, $\hat{\Lambda}_2=\sum\limits_{ijab}
\lambda^{ij}_{ab}\{{a}^\dagger_i {a}^\dagger_j a_b a_a\}$ 
are the singles and doubles de-excitation operators respectively. The CC gradient expression can now be expressed 
in terms of the lambda operator,
\\
\begin{equation}
\frac{\partial{E_{cc}}}{\partial X} = \bra{0}(1 + \hat{\Lambda}){\bar{H}}^X\ket{0} = \bra{0}(1 + \hat{\Lambda})e^{-\hat{T}}\frac{\partial{\hat H}}{\partial X}\ket{\Psi_{cc}}
\end{equation}
\\
and the governing equation for sloving the lambda amplitudes eq. (2.27) can be written in a more compact form as,
\\
\begin{equation}
\bra{0}(1 + \hat{\Lambda})(\bar{H} - E_{cc})\ket{\mu} = 0.
\end{equation}
\\
Thus, instead of taking the gradients of the non-linear $T$ amplitude
equations with respect to perturbations, we solve linear perturbation-independent 
$\hat{\Lambda}$ equations for calculating the CC energy gradient.
Furthermore, CC gradients satisfy the generalized Hellman-Feynman equation\cite{Feynman39}
if $\bra{0}(1 + \hat{\Lambda})e^{-\hat{T}}$ is defined to be the left hand wavefunction
as due to the non-hermiticity of the $\bar{H}$ operator or the non-variational nature of the 
CC method, the left and right hand wavefunctions are not simple hermitian conjugates of each other.
%However, for second order derivatives, we do need to calculate the first derivatives of 
%either the $T$ amplitudes with respect to a perturbation.
%The derivative of the similarity transformed hamiltonian can be expressed as:
%\begin{equation}
%\frac{\partial{\bar{H}}}{\partial X} = {\bar{H}}^X + \lbrack\bar H , \frac{\partial{\hat T}}{\partial X}\rbrack, 
%\end{equation}

%\\By combining the CC energy and amplitude equations, we can write:
%\begin{equation}
%E_{CC} = \bra{\Lambda}\hat{H}\ket{\Psi_{CC}}
%\end{equation}
%where
%\begin{equation}
%\bra{\Lambda} = \bra{\Psi_o} + \sum_{\mu}{\zeta_{\mu}}\bra{\mu}e^{-\hat{T}}
%\end{equation} In the above equation, $\bra{\mu}$ represents any excited Slater determinant.
%$\zeta_{\mu}$ can be obtained if the bra state (Lambda) obeys the schr\"odinger's
%equation.
%\begin{equation}
%\bra{\Lambda}\hat{H}e^{\hat{T}} = \bra{\Lambda}e^{\hat{T}}E_{cc}
%\end{equation}
%Right projecting the above equation onto the subspace \{$\ket{\nu}$\} (excited Slater determinants):
%\begin{equation}
%\sum_{\mu}\zeta_{\mu}A_{\mu\nu} = -\bra{\Psi_o}\lbrack\hat{H},\hat{\tau_{\nu}}\rbrack\ket{\Psi_{cc}}
%\end{equation}
%where $\hat{\tau_{\nu}}$ is an excitation operator:$\;\;\;\hat{\tau_{\nu}}\ket{\Psi_o} = \ket{\nu}$ , and 
%\begin{equation}
%A_{\mu\nu} = \bra{\mu}e^{-\hat{T}}\lbrack\hat{H},\hat{\tau_{\nu}}\rbrack\ket{\Psi_{cc}}
%\end{equation}
%We can solve for the parameters $\zeta_{\mu}$ from the above equation to get $\bra{\Lambda}.$ In the presence of a time-independent perturbation described by $\alpha \hat{V}$ with $\alpha$ as the strength parameter, the gradient of coupled cluster energy with respect to $\alpha$ at zero perturbation strength can be shown as:
%\begin{equation}
%\frac{\partial{E_{cc}}}{\partial {\alpha}}|_{\alpha=0} \;\;= \frac{\partial}{\partial{\alpha}}\bra{\Lambda (\alpha)}\hat{H}+\alpha \hat{V}\ket{\Psi_{CC}(\alpha)}|_{\alpha=0}\;\; = \;\;\;\bra{\Lambda}\hat{V}\ket{\Psi_{CC}}
%\end{equation}
%We are able to obtain the first order gradients of CC just by solving the linear
%lambda equations to get the $\zeta_{\mu}$ parameters and plugging them in the
%above expression. The $\bra{\Lambda}$ state is nothing the left hand coupled cluster wave
%function, as it is a solution to the Schr\"odinger equation and the above equation satisfies the 
%generalized Hellmann-Feynman theorem\cite{Feynman39}.
%%For full CC, $\bra{\Lambda}$ and $\ket{\Psi_{cc}}$ are just hermitian
%%conjugate, but they are different in case of truncated CC methods because %of
%%the non-hermiticity of $\bar{H}$ operator.
%\subsubsection{Coupled Cluster Linear Response (CCLR)}
%\paragraph{Exact states}~\\
%\paragraph{Coupled cluster linear response (CCLR)}~\\\\
\subsection{General Response Theory}
Response theory, as the name suggests, attempts to calculate molecular properties related 
to the response of the ground state wavefunction to an external perturbation. Within this 
formalism, the effect of an external electromagnetic field is incorporated into the 
Hamiltonian using the standard time-dependent perturbation theory:
\\
\begin{equation}
\begin{split}
& H = H_o + V(t)\\
&V(t) = \int_{-\infty}^{\infty}d\omega\;\;V(\omega) e^{(-i\omega + \alpha)t},
\end{split}
\end{equation}
\\
where $H_o$ is the time independent or unperturbed Hamiltonian, $V(t)$ is the interaction 
operator with $V(\omega)$ as its Fourier transform and $\alpha$ is a real postive infinitesimal.
The representation used for the $V(t)$ operator is an example of the adiabatically 
switched on perturbation\cite{Koch90} where the perturbation is assumed to be zero at 
$t = -\infty$. Thus, the molecule can be assumed to be in state $\Psi_o$, an 
eigenstate of $H_o$ at $t = -\infty$.
%In the presence of an external time dependent field,
%outline important steps for the
%derivations of both general and CCLR response functions and also talk about
%different gauge representations used for calculating the response functions.\\
%The operator $V(t)$ which describes the interaction between the molecule and 
%an external time-dependent field can be expressed in the frequency domain as: 
%\begin{equation}
%V(t) = \int_{-\infty}^{\infty}d\omega\;\;V(\omega) e^{(-i\omega + \Gamma)t} ,
%\end{equation}
%The full Hamiltonian can then be written as: $H = H_o + V(t)$, where $H_o$ is the
%time independent unperturbed Hamiltonian. Assuming that $\Psi_o$ is an eigenstate of $H_o$
%An exact wavefunction satisfies the Schr\"odinger equation: $H_o\ket{O} =
%E_o\ket{O}$ where $H_o$ is the time independent Hamiltonian and $\ket{O}$ is an
%eigenstate of the system. 
%Assuming that $\Psi_o$ is an eigenstate of $H_o$
%and that the molecule is in state $\Psi_o$ when the perturbation starts at $t = -\infty$, 
After the perturbation is switched on, the wavefunction becomes time dependent 
($\ket{\Psi_o(t)}$) and evolves in time according to the time-dependent
Schr\"odinger equation (TDSE).
\\
\begin{equation}
i\frac{d}{dt}\ket{\Psi_o(t)} = (H_o + V^t)\ket{\Psi_o(t)}
\end{equation}
\\
%It can be shown that the time dependent state $\ket{\Psi_o(t)}$ is related to 
Following the works of Olsen\cite{Olsen85}, the time dependent state $\ket{\Psi_o(t)}$
can be parametrized in terms of a phase factor ($\epsilon(t)$),
\\
\begin{equation}
\ket{\Psi_o(t)} = \ket{{\overbar{\Psi}_o}}e^{i\epsilon(t)}
\end{equation}
\\
where $\ket{{\overbar{\Psi}_o}}$ is the phase isolated wavefunction which can be expanded 
in orders of perturbation (time dependence is assumed).\\
\begin{equation}
\ket{\bar{\Psi_o}} = \ket{\Psi_o} + {\ket{\Psi_o}}^{(1)}+ {\ket{\Psi_o}}^{(2)} + ...
\end{equation}
\\
It should be noted that the phase factor cancels out when one takes an expectation
value of an operator with the wavefunction of equation 2.33 and hence can be 
ignored in the following derivations.
%where order correction ${\ket{\Psi_o}}^{(1)}$ and others can be determined 
%from the . 
%For calculating any response property, the
%expectation value of the respective time independent  operator is calculated in
%the presence of an external field. 
From the above equation, it can be seen that an expectation value of a time independent
operator $A$ can also be expanded in a similar fashion. The response functions are the 
Fourier transforms of these time dependent terms appearing in the expansion up to a given order.
\\
%\begin{equation}
%\bra{\Psi_o(t)}A\ket{\Psi_o(t)} = \bra{\Psi_o}A\ket{\Psi_o} + \int_{-\infty}^{\infty}d\omega_1{\langle\langle A;V({\omega_1})\rangle\rangle}_{\omega_1 + i\Gamma}e^{(-i\omega_1 + \Gamma)t} + .....
%\end{equation}
\begin{equation}
\begin{split}
\langle A \rangle (t) = \langle A \rangle + & \int_{-\infty}^{\infty}\
d\omega_1{\langle\langle A;V^{\omega_1}\rangle\rangle}_{\omega_1  \
+ i\alpha}e^{-i(\omega_1 + i\alpha)t} \\
& + \frac{1}{2} \int_{-\infty}^{\infty}d\omega_1\int_{-\infty}^{\infty}d\omega_2\
{\langle\langle A;V^{\omega_1};V^{\omega_2}\rangle\rangle}_{\omega_1 \
+ i\alpha,\omega_2 + i\alpha}e^{-i(\omega_1 + \omega_2 + 2i\alpha)t} + ..... \\
\end{split}
\end{equation}
\\
where the linear response function (LRF), $\langle\langle A;V^{\omega_1}\rangle\rangle$ can be
seen as the first order change in the expectation value of the time independent operator $A$ 
with respect to perturbation. The first order perturbed wavefunction $\ket{\Psi_o}^{(1)}$
can be obtained using Ehrenfest's theorem and combined with the above equation to construct 
the LRF, which for exact states looks like,
\\
\begin{equation}
\langle\langle A;V^{\omega_1}\rangle\rangle = \sum_k\bigg[
\frac{\bra{\Psi_o}A\ket{\Psi_k}\bra{\Psi_k}V^{\omega_1}\ket{\Psi_o}}{\omega_1
- \omega_k}  -
\frac{\bra{\Psi_o}V^{\omega_1}\ket{\Psi_k}\bra{\Psi_k}A\ket{\Psi_o}}{\omega_1 + \omega_k}\bigg]
\end{equation}
\\
%The above equation is called the sum of states (SOS) equation , 
where $\omega_k$ is the excitation energy between the states $\Psi_o$ and $\Psi_k$ 
and the summation runs over all the solutions of the time independent Schr\"odinger equation, $\Psi_k$.
%It can be seen from eq.(2) that $\textbf{G}^{\prime}(\omega)$ is nothing but the imaginary part of this 
%response function if we take $A$ as the dipole moment operator with $V$ as a magnetic field.
However, calculating response functions using the above equation (also known as the sum of states equation)
is very computationally expensive as it involves explicit calculations of all the excited states.
%\paragraph{CC linear response function}~\\\\
\subsection{Coupled Cluster Response Theory}
Coupled cluster response theory was proposed by Koch and J{\o}rgensen in 1990\cite{Koch90} as a recipe
for accurate calculations of response properties like dynamic (hyper)polarizabilities, optical
rotations, etc. It avoids the sum of states approach through a suitable parametrization of the CC wavefunction.
In this formalism, the right and left hand CC wavefunction evolve in time through time dependent $\hat{T}$
and $\hat{\Lambda}$ amplitudes,\cite{Koch90}
\\
\begin{equation}
\ket{\Psi_{cc}(t)} = e^{\hat{T}(t)}\ket{0}e^{i\epsilon(t)}
\end{equation}
\begin{equation} \bra{\Lambda(t)} = \{\bra{0} +
\sum_{\mu}\lambda_\mu(t)\bra{\mu}e^{-\hat{T}(t)}\}e^{-i\epsilon(t)}
\end{equation}
\\
where $e^{\pm i\epsilon(t)}$ is a time dependent phase factor. The governing equation for the time evolution of 
these amplitudes is the time-dependent Schr\"odinger equation.
\\
\begin{equation}
i\frac{d}{dt}\ket{\Psi_{cc}(t)} = (H_o + V(t))\ket{\Psi_{cc}(t)} 
\end{equation}
\begin{equation}
\frac{d}{dt}\bra{\Lambda(t)} = i\bra{\Lambda(t)}(H_o + V(t))
\end{equation}
\\
On multiplying eq. (2.39) by $e^{-\hat{T}(t)}$ on both sides and projecting 
it against the excited determinants $\bra{\mu}$, the time derivative expression
of the $t_{\mu}$ amplitudes can be obtained.
\\
\begin{equation}
\frac{dt_{\mu}}{dt} = -i\bra{\mu}e^{-\hat{T}(t)}(H_o + V(t))e^{\hat{T}(t)}\ket{0}
\end{equation}
\\
Similarly, multiplying eq.(2.40) by $e^{i\epsilon(t)}$ and invoking the RI, the time derivative 
equation of the $\lambda_{\mu}$ amplitudes can be derived.
\\
\begin{equation}
\frac{d\lambda_{\mu}}{dt} = i\bra{{\tilde{\Lambda}}(t)}\lbrack H_o + V(t),\tau_\mu
\rbrack\ket{{\widetilde{\Psi}_{cc}}(t)}
\end{equation} 
\\
where $\sim$ denotes the usual expressions without the phase factor $e^{\pm i\epsilon(t)}$. 
The amplitudes are then expanded in orders of the perturbation which is followed by a Fourier transformation.
\\
\begin{equation}
\begin{split}
t_\mu(t) &= t^{(0)}_\mu +  t^{(1)}_\mu +  t^{(2)}_\mu + ... \\
&= t^{(0)}_\mu +  \int_{-\infty}^{\infty} d\omega_1 X^{(1)}_\mu(\omega_1 + i\alpha)e^{(-i\omega_1 + \alpha) t}  + ... \\
\end{split}
\end{equation}
\\
\begin{equation}
\begin{split}
\lambda_\mu(t) &= \lambda^{(0)}_\mu +  \lambda^{(1)}_\mu +  \lambda^{(2)}_\mu + ... \\
&= \lambda^{(0)}_\mu +  \int_{-\infty}^{\infty} d\omega_1 Y^{(1)}_\mu(\omega_1 + i\alpha)e^{(-i\omega_1 + \alpha) t}  + ... \\
\end{split}
\end{equation}
\\
Using 2.41-2.44, the equations for solving the Fourier transforms 
$X^{(1)}_\mu$ and $Y^{(1)}_\mu$ can be derived, 
\\
\begin{equation}
\begin{split}
&\sum_\nu {((\omega_1 + i\alpha)\bm{I} - \bm{A})}_{\mu\nu} X^{(1)}_{\nu}
= -\langle \mu|\overbar{V}^{\omega_1}|0 \rangle \\
&\sum_\nu Y_{\nu}^{(1)}{((\omega_1 + i\alpha)\bm{I} + \bm{A})}_{\nu\mu} = -\eta^{(1)}_{\mu} -
\sum_{\gamma} F_{\mu\gamma} X^{(1)}_{\gamma}.
\end{split}
\end{equation}
\\
Here $\bm{I}$ is the identity matrix and $\bm{A}$ is the (unsymmetric) CC Jacobian,
\begin{equation}
A_{\mu\nu} = \bra{\mu}[\bar{H_o}, \tau_\nu]\ket{0}
\end{equation}
where overbar on an operator denotes similarity transformation with the ground state
$T$ operator, ex. $\bar{H_o} = e^{-\hat{T(0)}}\hat{A}e^{\hat{T(0)}}$.
The $\bm{\eta}^{(1)}$ vector and the symmetric $\bm{F}$ matrix are defined as,
\\
\begin{equation}
\begin{split}
& F_{\mu\nu} = \bra{(1+ \hat{\Lambda)}}[[\bar{H_o}, \tau_\mu],\tau_\nu]\ket{0}\\
& \eta^{(1)}_{\mu} = \bra{(1+ \hat{\Lambda})}[\overbar{V}^{\omega_1}, \tau_\mu]\ket{0}.\\
\end{split}
\end{equation}
\\
For a CC wavefunction, time-dependent expectation value of a time-independent operator 
$A$ is defined as\cite{Pedersen97},
\\
\begin{equation}
\begin{split}
{\langle A \rangle}_{CC} (t) = & Re [\langle \Lambda(t) | A | CC(t)\rangle ]\\
& = \frac{1}{2} (\langle \Lambda(t) | A | CC(t)\rangle  + {\langle \Lambda(t) | A | CC(t)\rangle}^{*})
\end{split}
\end{equation}
\\
since both $\hat{T}$ and $\hat{\Lambda}$ amplitudes can be complex quantities but 
the expectation values should always be real. To identify CC response functions,  
the quantity $\langle \Lambda(t) | A | CC(t)\rangle$ is expanded in orders of 
perturbation\cite{Pedersen97}.
\\
\begin{equation}
\begin{split}
\langle \Lambda(t) | A | CC(t) \rangle & = {\langle \Lambda(t) | A | CC(t) \rangle}^{(0)}\
 + {\langle \Lambda(t) | A | CC(t) \rangle}^{(1)} \
+ {\langle \Lambda(t) | A | CC(t) \rangle}^{(2)} + ... \\
& = \langle \Lambda | A | CC \rangle + \int_{-\infty}^{\infty}d\omega_1 \
F^{A;V^{\omega_1}}_{\omega_1 + i\alpha}e^{-i(\omega_1 + i\alpha)t} \\
& + \frac{1}{2} \int_{-\infty}^{\infty}d\omega_1\int_{-\infty}^{\infty}d\omega_2\
F^{A;V^{\omega_1};V^{\omega_2}}_{\omega_1 + i\alpha,\omega_2 \
+ i\alpha}e^{-i(\omega_1 + \omega_2 + 2i\alpha)t} + .....
\end{split}
\end{equation}
\\
From eqns 2.48 and 2.49 and using the relation $F^{V^{\omega_1};A}_{-\omega_1}=F^{A;V^{\omega_1}}_{\omega_1}$, the CC-LRF can be identified as,
\\
\begin{equation}
{\langle\langle A;V^{\omega_1} \rangle\rangle}_{\omega_1 + i\alpha} \
= \frac{1}{2}( F^{A;V^{\omega_1}}_{\omega_1 + i\alpha} + \
(F^{V^{\omega_1};A}_{\omega_1 + i\alpha})^{*}).
\end{equation}
or,
\begin{equation}
{\langle\langle A;B\rangle\rangle}_{\omega_1} =  \frac{1}{2}\hat{P}(A,B)[\langle 0 | \
[\hat{Y}^{B}_{\omega_1}, \bar{A}]|0\rangle + \langle 0 | \
(1 + \hat{\Lambda})|[\bar{A},\hat{X}^{B}_{\omega_1}]|0\rangle]
\end{equation}
\\
where $V^{\omega_1} = B$, $\hat{P}(A,B)$ simultaneously interchanges operators $A$ and $B$
and takes the complex conjugate of the expression,
and $\hat{X}^{B}_{\omega_1}$ and $\hat{Y}^{B}_{\omega_1}$ are the first-order right 
and left hand perturbed amplitudes corresponding to operator
$B$ respectively. An alternative formulation of the CC-LRF avoids calculating $\hat{Y}_{\omega_1}$
amplitudes by solving an extra set of $\hat{X}_{-\omega_1}$ amplitudes,
\\
\begin{equation}
{\langle\langle A;B \rangle\rangle}_{\omega_1}=
\frac{1}{2}\hat{C}^{\pm\omega_1}\hat{P'}[A(-\omega_1),B(+\omega_1)] \left[
\langle0|(1+\hat{\Lambda})\left( [\bar{A},\hat{X}^B_{\omega_1}] +
\frac{1}{2}[[\bar{H_o},\hat{X}^{A}_{-\omega_1}], \hat{X}^{B}_{\omega_1}]
\right) |0\rangle \right]
\label{Eq:linresp}
\end{equation}
\\
where $\hat{C}$ is a symmetrizer that simultaneously interchanges the sign of the field 
frequency and takes the complex conjugate of the expression, and $\hat{P'}$ symmetrizes 
the expression with respect to the operators $A$ and $B$. Both the approaches are computationally
equivalent but using the former approach, one can express the LRF in terms of perturbed 
one electron densities. It should be noted that the LRFs can also be defined as second-order derivatives
of a time-averaged quasi-energy with respect to external perturbations $A$ and
$B$. This formalism is specially useful for deriving LRFs for approximate coupled cluster theories 
like CC2\cite{Christiansen95:CC2}.\\
The equations derived in this section have been used in the following chapters to calculate CCSD and 
CC2 dynamic polarizabilities and specific rotations.
% need a concluding pargraph as to how these equations would be used 
% for this work.
%Expanding the $t^{a.}_{i.}$ amplitudes in orders of perturbation of V(t), the 
%expressions for the different orders can be obtained using eq. (38). The first order
%derivative can be written as:
%%\begin{equation}
%%t_\mu(t) = {t}^{(0)}_\mu(t) +  {t}^{(1)}_\mu(t) +  {t}^{(2)}_\mu(t) + ...
%%\end{equation}
%%\begin{equation}
%%i\frac{d\;{t^{a.}_{i.}}^{(0)}}{dt} = \bra{\Psi^{a.}_{i.}}e^{-\hat{T}(0)}H_o\ket{\Psi_{cc}} = 0 ,
%%\end{equation}
%\begin{equation}
%i\frac{d\;{t^{a.}_{i.}}^{(1)}}{dt} = \bra{\Psi^{a.}_{i.}}e^{-\hat{T}(0)}V(t)\ket{\Psi_{cc}} + \bra{\Psi^{a.}_{i.}}e^{-\hat{T}(0)}\lbrack H_o,T^{(1)}\rbrack\ket{\Psi_{cc}}
%\end{equation}
%The amplitude $t^{a.}_{i.}$ can be expressed in terms of its Fourier transform as: 
%\begin{equation}
%{t^{a.}_{i.}}^{(1)}(t) = \int_{-\infty}^{\infty} d\omega_1{X^{a.}_{i.}}^{(1)}(\omega_1 + i\Gamma)e^{(-i\omega_1 + \Gamma) t}
%\end{equation}
%where
%\begin{equation}
%{X^{a.}_{i.}}^{(1)}(\omega_1 + i\Gamma)  = \sum_{j.b.}{\left\{{(-A + (\omega_1 + i \Gamma) I )}^{-1}\right\}}^{j.b.}_{i.a.}{\lambda^{b.}_{j.}}^{(1)}(\omega_1),
%\end{equation}
%and  
%\begin{equation}
%{\lambda^{b.}_{j.}}^{(1)}(\omega_1) = \bra{\Psi^{b.}_{j.}}e^{-\hat{T}(0)}V(\omega_1)\ket{\Psi_{cc}}.
%\end{equation}
%$A$ is the coupled cluster Jacobian matrix defined as:
%\begin{equation}
%A^{j.b.}_{i.a.} = \bra{\Psi^{a.}_{i.}}e^{-\hat{T}}\lbrack H_o,\{{a}^\dagger_b.a_j.\}\rbrack\ket{\Psi_{cc}}
%\end{equation}
%The above process is repeated with $\lambda^{j.}_{b.}$ amplitudes to obtain the derivative expressions and the Fourier transform $Y$.
%\begin{equation}
%\frac{d\;{\lambda^{b.}_{j.}}^{(1)}}{dt} = i\bra{\Lambda}(\lbrack\lbrack H_o,\{{a}^\dagger_b.a_j.\}\rbrack,T^{(1)}\rbrack + \lbrack V(t),\{{a}^\dagger_b.a_j.\}\rbrack)\ket{\Psi_{cc}} + i\sum_{i.a.} {\lambda^{a.}_{i.}}^{(1)}A^{j.b.}_{i.a.} 
%\end{equation}
%\begin{equation} 
%{Y^{a.}_{i.}}^{(1)}(\omega_1 + i\Gamma) = - \sum_{j.b.}{\eta^{b.}_{j.}}^{(1)}(\omega_1) + \sum_{k.c.}F^{k.c.}_{j.b.} {X^{c.}_{k.}}^{(1)}(\omega_1 + i\Gamma)) \times\{{(A + (\omega_1 + i\Gamma)I)}^{-1}\}^{i.a.}_{j.b.}
%\end{equation}
%where
%\begin{equation}
%{\eta^{b.}_{j.}}^{(1)}(\omega_1) = \bra{\Lambda}\lbrack V(\omega_1),\{{a}^\dagger_b.a_j.\}\rbrack\ket{\Psi_{cc}} ,
%\end{equation}
%and 
%\begin{equation}
%F^{k.c.}_{j.b.} = \bra{\Lambda}\lbrack\lbrack H_o,\{{a}^\dagger_b.a_j.\}\rbrack,\{{a}^\dagger_c.a_k.\}\rbrack\ket{\Psi_{cc}}  
%\end{equation}
%The expectation value of any time dependent operator $A$ in CC can be expanded in orders of perturbation.
%\begin{equation}
%\langle A \rangle = \bra{\Lambda}A\ket{\Psi_{cc}} + \sum_{i.a.}{\lambda^{a.}_{i.}}^{(1)}\bra{\Psi^{a.}_{i.}}e^{-\hat{T}(0)}A\ket{\Psi_{cc}} + \bra{\Lambda}\lbrack A,T^{(1)}\rbrack\ket{\Psi_{cc}} + .....
%\end{equation}
%Comparing this with equation (34), the CC linear response function can be determined.
%\begin{equation}
%\int_{-\infty}^{\infty}d\omega_1{\langle\langle A;V(\omega_1)\rangle\rangle}_{\omega_1 + i \Gamma}e^{(-i\omega_1 + \Gamma)t} \equiv \sum_{i.a.}{\lambda^{a.}_{i.}}^{(1)}\bra{\Psi^{a.}_{i.}}e^{-\hat{T}(0)}A\ket{\Psi_{cc}} + \bra{\Lambda}\lbrack A,T^{(1)}\rbrack\ket{\Psi_{cc}}
%\end{equation}
%In more general terms, the response function can be written as:
%\begin{equation}
%{\langle\langle A;B\rangle\rangle}_{\omega_1} = \sum_{i.a.} \bra{\Lambda}\lbrack A,\{{a}^\dagger_a.a_i.\}\rbrack\ket{ \Psi_{cc}}{X^{a.}_{i.}}(B,\omega_1) + \sum_{i.a.}\left\{\bra{\Lambda}\lbrack B,\{{a}^\dagger_a.a_i.\}\rbrack\ket{\Psi_{cc}} + \sum_{k.c.}F^{k.c.}_{i.a.}{X^{c.}_{k.}}(B,\omega_1)\right\}{X^{a.}_{i.}}(A,-\omega_1).
%\end{equation}
%where \centerline{${X^{a.}_{i.}}(B,\omega_1) = \sum_{j.b.}\left\{ {( -A + \omega_1I)}^{-1}\right\}^{j.b.}_{i.a.}\;B^{b.}_{j.},$}\\and \centerline{ $B^{b.}_{j.} = \bra{\Psi^{a.}_{i.}}e^{-\hat{T}(0)}B\ket{\Psi_{cc}}$ .}\\\\
%Thus for calculating the response functions, we need to solve two sets of
%linear equations for obtaining ${X^{a.}_{i.}}(B,\omega_1)$ and
%${X^{a.}_{i.}}(A,-\omega_1)$.

%\newpage
%\paragraph{Optical rotation calculations}~\\
%Rosenfeld,\cite{Rosenfeld29} using semi-classical electrodynamic theory, showed
%that the induced electric dipole moment can be written as: \begin{equation}
%\langle\vec{\mu}\rangle = \alpha\vec{E} +
%\frac{1}{\omega}\textbf{G}^\prime\frac{\partial\vec{B}}{\partial t}
%\end{equation}
%where $\vec{E} $ and $\vec{B}$ are electric and magnetic field vectors
%respectively, $\alpha$ is the electric dipole polarizability tensor while
%$\textbf{G}^\prime$ tensor is the key quantity for calculating optical
%rotation.  \begin{equation}
%\textbf{G}^{\prime}_{xy}(\omega) = -\frac{2}{\hbar} Im\sum_{n \neq 0}\frac{\omega\; \bra{\psi_o}\mu_x\ket{\psi_n}\bra{\psi_n}m_y\ket{\psi_o}}{\omega^{2}_{n0}-\omega^2}
%\end{equation}
%where $\mu$ and $m$ are electric and magnetic dipole operators: $\mu = \sum_i
%r_i , m= \sum_ir_i\times p_i$ in atomic units. $\omega$ is the frequency of
%light, $\omega_{no}$ is the excitation energy for the $n^{th}$ state ($\psi_n$) and
%$Im$ means the imaginary part of the equation. The trace of this tensor is related
%to the specific rotation, usually denoted as ${\lbrack\alpha\rbrack}_\omega $ in
%deg dm$^{\text{-1}}$(g/mL)$^{\text{-1}}$. After averaging over all possible
%orientations of the molecule, the following expression is obtained\cite{Crawford06}. \begin{equation}
%{\lbrack\alpha\rbrack}_{\omega} = \frac{(72.0 \times 10^6){\hbar}^2 N_A\;\omega}{c^2{m_e}^2 M} \times \left[ \frac{1}{3}Tr(\textbf{G}^\prime)\right]
%\end{equation}
%where $\textbf{G}^\prime$ and $\omega$ are in atomic units, $N_A$ is Avogadro's number, c is the speed of light in (m/s), m$_{\text{e}}$ is the mass of electron (kg) and M is the molecular mass (amu). The $\textbf{G}^\prime$ tensor can be obtained from using the CCLR method.



%Thus, we can use this linear response formalism and can calculate the $\textbf{G}^\prime$ tensor
%using eq.(4) in which A is the dipole moment operator and B is the magnetic field. However, there 
%can be different representations of an operator which are referred to as gauges. It is observed that 
%in the truncated CCLR method if the length gauge representation of the dipole operator is used, i.e. $\mu \equiv r$ (in atomic units), the optical rotation results are origin dependent. This problem is overcome in CCLR by using the velocity
%gauge representation where $\mu \equiv r\times p$. However, both these gauges are equivalent for 
%exact wavefunctions. However, the velcity gauge calculated optical rotation does not decay to zero 
%at the static limit, i.e. when the external field is zero, which is an unphysical result. 
%To correct this problem, another representation called the modified velocity gauge (MVG)
%proposed by Pedersen \cite{Pedersen04} is used which shifts the values obtained
%by velocity gauge by its static limit. 



%\begin{equation}
%\textbf{G}^{\prime}(\omega) = \text{-Im}\langle\langle\mu;m\rangle\rangle \equiv \text{- Im}\langle\langle r;r\times p\rangle\rangle
%\end{equation} 
%The above results obtained using the length gauge representation ($\mu
%\equiv r$) above, however is origin dependent. This is fixed by using the velocity
%gauge representation where the dipole moment operator is written as a momentum operator ($\mu
%\equiv {\frac{p}{\omega}}$) . Length and velocity gauge representations are equivalent for exact 
%wavefunctions.
%\begin{equation}
%\text{Tr}{\langle\langle r;r\times p\rangle\rangle}_{\omega} = \frac{1}{\omega}\text{Tr}{\langle\langle p;r\times p\rangle\rangle}_{\omega} 
%\end{equation}
%However, the velocity gauge calculations does not decay to zero at the static
%limit, i.e when the external field is zero, which is an unphysical result. To
%overcome this, another representation called modified velocity gauge (MVG)
%proposed by Pedersen \cite{Pedersen04} is used which shifts the values obtained
%by velocity gauge by it's static limit value.

